{"timestamp":"2025-08-18T11:28:44.801895","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-08-18T11:28:44.802261","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/stock_etl_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-08-18T11:28:44.935106","level":"warning","event":"Using Connection.get_connection_from_secrets from `airflow.models` is deprecated.Please use `from airflow.sdk import Connection` instead","category":"DeprecationWarning","filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py","lineno":471,"logger":"py.warnings"}
{"timestamp":"2025-08-18T11:28:44.940201","level":"info","event":"Connection Retrieved 'postgres_default'","logger":"airflow.hooks.base"}
{"timestamp":"2025-08-18T11:28:44.953786Z","level":"error","event":"ERROR - Validation check price_gap_check failed: '>' not supported between instances of 'NoneType' and 'float'","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-18T11:28:44.953785","level":"error","event":"Validation check price_gap_check failed: '>' not supported between instances of 'NoneType' and 'float'","logger":"data_validation"}
{"timestamp":"2025-08-18T11:28:44.955709Z","level":"error","event":"ERROR - Validation check ohlc_consistency failed: duplicate key value violates unique constraint \"unique_instrument_date_metric\"","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-18T11:28:44.955961Z","level":"error","event":"DETAIL:  Key (instrument_id, metric_date, metric_name)=(1, 2025-08-18, ohlc_consistency) already exists.","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-18T11:28:44.956165Z","level":"error","event":"","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-18T11:28:44.956408Z","level":"error","event":"ERROR - Validation check volume_consistency failed: current transaction is aborted, commands ignored until end of transaction block","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-18T11:28:44.956637Z","level":"error","event":"","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-18T11:28:44.955711","level":"error","event":"Validation check ohlc_consistency failed: duplicate key value violates unique constraint \"unique_instrument_date_metric\"\nDETAIL:  Key (instrument_id, metric_date, metric_name)=(1, 2025-08-18, ohlc_consistency) already exists.\n","logger":"data_validation"}
{"timestamp":"2025-08-18T11:28:44.956316","level":"error","event":"Validation check volume_consistency failed: current transaction is aborted, commands ignored until end of transaction block\n","logger":"data_validation"}
{"timestamp":"2025-08-18T11:28:44.956725","level":"info","event":"Data validation completed: 0/0 checks passed","logger":"data_validation"}
{"timestamp":"2025-08-18T11:28:44.957459Z","level":"error","event":"INFO - Data validation completed: 0/0 checks passed","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-18T11:28:44.956894","level":"info","event":"Done. Returned value was: {'total_checks': 0, 'passed_checks': 0, 'failed_checks': 3, 'metrics': []}","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-08-18T11:28:44.957063","level":"info","event":"Pushing xcom","ti":"RuntimeTaskInstance(id=UUID('0198bcf0-1ee4-7e1b-a06c-a63f0de083e4'), task_id='validate_data_quality', dag_id='dev_***_etl_pipeline', run_id='manual__2025-08-18T11:28:29.719733+00:00_nH9KHZXl', try_number=1, map_index=-1, hostname='8693994aa8cd', context_carrier=None, task=<Task(PythonOperator): validate_data_quality>, bundle_instance=LocalDagBundle(name=dags-folder), max_tries=1, start_date=datetime.datetime(2025, 8, 18, 11, 28, 44, 783443, tzinfo=datetime.timezone.utc), end_date=None, state=<TaskInstanceState.RUNNING: 'running'>, is_mapped=False, rendered_map_index=None, log_url='http://localhost:8080/dags/dev_***_etl_pipeline/runs/manual__2025-08-18T11%3A28%3A29.719733%2B00%3A00_nH9KHZXl/tasks/validate_data_quality?try_number=1')","logger":"task"}
