{"timestamp":"2025-08-18T11:28:42.683543","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-08-18T11:28:42.683866","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/stock_etl_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-08-18T11:28:42.796948Z","level":"error","event":"INFO - Extracting data for 2025-08-18 - instruments: all","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-18T11:28:42.796952","level":"info","event":"Extracting data for 2025-08-18 - instruments: all","logger":"extract_transform"}
{"timestamp":"2025-08-18T11:28:42.797668","level":"warning","event":"Using Connection.get_connection_from_secrets from `airflow.models` is deprecated.Please use `from airflow.sdk import Connection` instead","category":"DeprecationWarning","filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py","lineno":471,"logger":"py.warnings"}
{"timestamp":"2025-08-18T11:28:42.801262","level":"info","event":"Connection Retrieved 'postgres_default'","logger":"airflow.hooks.base"}
{"timestamp":"2025-08-18T11:28:42.809816Z","level":"error","event":"INFO - Extraction completed: 3 records in 9ms","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-18T11:28:42.809809","level":"info","event":"Extraction completed: 3 records in 9ms","logger":"extract_transform"}
{"timestamp":"2025-08-18T11:28:42.809988","level":"info","event":"Done. Returned value was: {'data': {'***s': [{'symbol': 'XTB', 'trading_date': datetime.date(2025, 8, 18), 'open_price': 6.75, 'high_price': 6.85, 'low_price': 6.65, 'close_price': 6.8, 'volume': 750000, 'adjusted_close': 6.8, 'split_factor': 1.0, 'dividend_amount': 0.0, 'data_source': 'stooq', 'raw_data_hash': 'abc123def456'}, {'symbol': 'PKN', 'trading_date': datetime.date(2025, 8, 18), 'open_price': 87.5, 'high_price': 89.2, 'low_price': 86.8, 'close_price': 88.75, 'volume': 1200000, 'adjusted_close': 88.75, 'split_factor': 1.0, 'dividend_amount': 0.0, 'data_source': 'stooq', 'raw_data_hash': 'def456ghi789'}], 'indices': [{'symbol': 'WIG', 'trading_date': datetime.date(2025, 8, 18), 'open_value': 75500.0, 'high_value': 76200.0, 'low_value': 75200.0, 'close_value': 75900.0, 'trading_volume': 25000, 'total_market_cap': 750000000000.0, 'constituents_traded': 350, 'data_source': 'stooq', 'raw_data_hash': 'ghi789jkl012'}]}, 'total_records': 3, 'processing_time_ms': 9, 'data_sources': ['stooq'], 'target_date': '2025-08-18', 'status': 'success'}","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-08-18T11:28:42.810142","level":"info","event":"Pushing xcom","ti":"RuntimeTaskInstance(id=UUID('0198bcf0-1ee2-70c7-8ea8-79e077c2ead6'), task_id='extract_and_transform', dag_id='dev_***_etl_pipeline', run_id='manual__2025-08-18T11:28:29.719733+00:00_nH9KHZXl', try_number=1, map_index=-1, hostname='8693994aa8cd', context_carrier=None, task=<Task(PythonOperator): extract_and_transform>, bundle_instance=LocalDagBundle(name=dags-folder), max_tries=1, start_date=datetime.datetime(2025, 8, 18, 11, 28, 42, 668345, tzinfo=datetime.timezone.utc), end_date=None, state=<TaskInstanceState.RUNNING: 'running'>, is_mapped=False, rendered_map_index=None, log_url='http://localhost:8080/dags/dev_***_etl_pipeline/runs/manual__2025-08-18T11%3A28%3A29.719733%2B00%3A00_nH9KHZXl/tasks/extract_and_transform?try_number=1')","logger":"task"}
