{"timestamp":"2025-08-18T11:26:39.973576","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-08-18T11:26:39.973865","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/stock_etl_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-08-18T11:26:40.084646","level":"warning","event":"Using Connection.get_connection_from_secrets from `airflow.models` is deprecated.Please use `from airflow.sdk import Connection` instead","category":"DeprecationWarning","filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py","lineno":471,"logger":"py.warnings"}
{"timestamp":"2025-08-18T11:26:40.088726","level":"info","event":"Connection Retrieved 'postgres_default'","logger":"airflow.hooks.base"}
{"timestamp":"2025-08-18T11:26:40.099975Z","level":"error","event":"ERROR - Validation check price_gap_check failed: '>' not supported between instances of 'NoneType' and 'float'","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-18T11:26:40.099974","level":"error","event":"Validation check price_gap_check failed: '>' not supported between instances of 'NoneType' and 'float'","logger":"data_validation"}
{"timestamp":"2025-08-18T11:26:40.101872Z","level":"error","event":"ERROR - Validation check ohlc_consistency failed: duplicate key value violates unique constraint \"unique_instrument_date_metric\"","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-18T11:26:40.102064Z","level":"error","event":"DETAIL:  Key (instrument_id, metric_date, metric_name)=(1, 2025-08-18, ohlc_consistency) already exists.","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-18T11:26:40.102270Z","level":"error","event":"","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-18T11:26:40.102492Z","level":"error","event":"ERROR - Validation check volume_consistency failed: current transaction is aborted, commands ignored until end of transaction block","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-18T11:26:40.102679Z","level":"error","event":"","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-18T11:26:40.101873","level":"error","event":"Validation check ohlc_consistency failed: duplicate key value violates unique constraint \"unique_instrument_date_metric\"\nDETAIL:  Key (instrument_id, metric_date, metric_name)=(1, 2025-08-18, ohlc_consistency) already exists.\n","logger":"data_validation"}
{"timestamp":"2025-08-18T11:26:40.102318","level":"error","event":"Validation check volume_consistency failed: current transaction is aborted, commands ignored until end of transaction block\n","logger":"data_validation"}
{"timestamp":"2025-08-18T11:26:40.102630","level":"info","event":"Data validation completed: 0/0 checks passed","logger":"data_validation"}
{"timestamp":"2025-08-18T11:26:40.102760","level":"info","event":"Done. Returned value was: {'total_checks': 0, 'passed_checks': 0, 'failed_checks': 3, 'metrics': []}","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-08-18T11:26:40.103617Z","level":"error","event":"INFO - Data validation completed: 0/0 checks passed","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-18T11:26:40.102898","level":"info","event":"Pushing xcom","ti":"RuntimeTaskInstance(id=UUID('0198bcee-6095-7e78-83ec-3bf271d51915'), task_id='validate_data_quality', dag_id='dev_***_etl_pipeline', run_id='manual__2025-08-18T11:26:35.465202+00:00_TYkxahNh', try_number=1, map_index=-1, hostname='8693994aa8cd', context_carrier=None, task=<Task(PythonOperator): validate_data_quality>, bundle_instance=LocalDagBundle(name=dags-folder), max_tries=1, start_date=datetime.datetime(2025, 8, 18, 11, 26, 39, 957952, tzinfo=datetime.timezone.utc), end_date=None, state=<TaskInstanceState.RUNNING: 'running'>, is_mapped=False, rendered_map_index=None, log_url='http://localhost:8080/dags/dev_***_etl_pipeline/runs/manual__2025-08-18T11%3A26%3A35.465202%2B00%3A00_TYkxahNh/tasks/validate_data_quality?try_number=1')","logger":"task"}
