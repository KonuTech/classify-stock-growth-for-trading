{"timestamp":"2025-08-18T11:18:46.945929","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-08-18T11:18:46.946238","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/stock_etl_dag.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-08-18T11:18:47.058354","level":"warning","event":"Using Connection.get_connection_from_secrets from `airflow.models` is deprecated.Please use `from airflow.sdk import Connection` instead","category":"DeprecationWarning","filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py","lineno":471,"logger":"py.warnings"}
{"timestamp":"2025-08-18T11:18:47.065457","level":"info","event":"Connection Retrieved 'postgres_default'","logger":"airflow.hooks.base"}
{"timestamp":"2025-08-18T11:18:47.076756Z","level":"error","event":"ERROR - Validation check price_gap_check failed: '>' not supported between instances of 'NoneType' and 'float'","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-18T11:18:47.076756","level":"error","event":"Validation check price_gap_check failed: '>' not supported between instances of 'NoneType' and 'float'","logger":"data_validation"}
{"timestamp":"2025-08-18T11:18:47.082559Z","level":"error","event":"INFO - Data validation completed: 4/4 checks passed","chan":"stderr","logger":"task"}
{"timestamp":"2025-08-18T11:18:47.082559","level":"info","event":"Data validation completed: 4/4 checks passed","logger":"data_validation"}
{"timestamp":"2025-08-18T11:18:47.082711","level":"info","event":"Done. Returned value was: {'total_checks': 4, 'passed_checks': 4, 'failed_checks': 1, 'metrics': [{'instrument': 'XTB', 'metric': 'ohlc_consistency', 'value': 1.0, 'valid': True, 'severity': 'info'}, {'instrument': 'PKN', 'metric': 'ohlc_consistency', 'value': 1.0, 'valid': True, 'severity': 'info'}, {'instrument': 'XTB', 'metric': 'volume_consistency', 'value': 750000.0, 'valid': True, 'severity': 'info'}, {'instrument': 'PKN', 'metric': 'volume_consistency', 'value': 1200000.0, 'valid': True, 'severity': 'info'}]}","logger":"airflow.task.operators.airflow.providers.standard.operators.python.PythonOperator"}
{"timestamp":"2025-08-18T11:18:47.082823","level":"info","event":"Pushing xcom","ti":"RuntimeTaskInstance(id=UUID('0198bce6-abde-76c3-b87f-7f4bbaa5fb01'), task_id='validate_data_quality', dag_id='dev_***_etl_pipeline', run_id='manual__2025-08-18T11:18:10.442204+00:00_wHFjQwkf', try_number=1, map_index=-1, hostname='8693994aa8cd', context_carrier=None, task=<Task(PythonOperator): validate_data_quality>, bundle_instance=LocalDagBundle(name=dags-folder), max_tries=1, start_date=datetime.datetime(2025, 8, 18, 11, 18, 46, 926439, tzinfo=datetime.timezone.utc), end_date=None, state=<TaskInstanceState.RUNNING: 'running'>, is_mapped=False, rendered_map_index=None, log_url='http://localhost:8080/dags/dev_***_etl_pipeline/runs/manual__2025-08-18T11%3A18%3A10.442204%2B00%3A00_wHFjQwkf/tasks/validate_data_quality?try_number=1')","logger":"task"}
