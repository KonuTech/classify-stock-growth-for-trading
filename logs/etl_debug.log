2025-08-17 21:35:07,701 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpeomp68me.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T19:35:07.700953Z"}
2025-08-17 21:35:07,701 - stock_etl.core.database - INFO - {"file_size": 16568, "estimated_statements": 76, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T19:35:07.701389Z"}
2025-08-17 21:35:07,891 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T19:35:07.891727Z"}
2025-08-17 21:35:07,919 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T19:35:07.919674Z"}
2025-08-17 21:35:07,920 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T19:35:07.920655Z"}
2025-08-17 21:35:07,920 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T19:35:07.920909Z"}
2025-08-17 21:35:07,993 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T19:35:07.993761Z"}
2025-08-17 21:35:07,995 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T19:35:07.995179Z"}
2025-08-17 21:35:07,997 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T19:35:07.997077Z"}
2025-08-17 21:35:07,997 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T19:35:07.997351Z"}
2025-08-17 21:35:07,998 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T19:35:07.998080Z"}
2025-08-17 21:35:07,998 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T19:35:07.998378Z"}
2025-08-17 21:35:08,020 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T19:35:08.020117Z"}
2025-08-18 00:02:14,870 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp9ydk8e0k.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T22:02:14.870818Z"}
2025-08-18 00:02:14,871 - stock_etl.core.database - INFO - {"file_size": 16568, "estimated_statements": 76, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T22:02:14.871295Z"}
2025-08-18 00:02:15,044 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T22:02:15.044280Z"}
2025-08-18 00:02:15,062 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T22:02:15.062137Z"}
2025-08-18 00:02:15,062 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T22:02:15.062742Z"}
2025-08-18 00:02:15,063 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T22:02:15.063005Z"}
2025-08-18 00:02:15,160 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T22:02:15.160307Z"}
2025-08-18 00:02:15,161 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T22:02:15.161555Z"}
2025-08-18 00:02:15,163 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T22:02:15.163345Z"}
2025-08-18 00:02:15,163 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T22:02:15.163596Z"}
2025-08-18 00:02:15,164 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T22:02:15.164493Z"}
2025-08-18 00:02:15,164 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T22:02:15.164756Z"}
2025-08-18 00:02:15,187 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-17T22:02:15.187677Z"}
2025-08-18 10:27:45,217 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp9f6vzkx_.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:27:45.217863Z"}
2025-08-18 10:27:45,218 - stock_etl.core.database - INFO - {"file_size": 16568, "estimated_statements": 76, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:27:45.218287Z"}
2025-08-18 10:27:45,421 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:27:45.421625Z"}
2025-08-18 10:27:45,446 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:27:45.446570Z"}
2025-08-18 10:27:45,447 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:27:45.447228Z"}
2025-08-18 10:27:45,447 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:27:45.447479Z"}
2025-08-18 10:27:45,509 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:27:45.509147Z"}
2025-08-18 10:27:45,510 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:27:45.510566Z"}
2025-08-18 10:27:45,512 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:27:45.512436Z"}
2025-08-18 10:27:45,512 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:27:45.512699Z"}
2025-08-18 10:27:45,513 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:27:45.513284Z"}
2025-08-18 10:27:45,513 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:27:45.513519Z"}
2025-08-18 10:27:45,534 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:27:45.534232Z"}
2025-08-18 10:53:01,808 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp1fydbgv8.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:53:01.808068Z"}
2025-08-18 10:53:01,808 - stock_etl.core.database - INFO - {"file_size": 16568, "estimated_statements": 76, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:53:01.808441Z"}
2025-08-18 10:53:01,981 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:53:01.981807Z"}
2025-08-18 10:53:02,008 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:53:02.008397Z"}
2025-08-18 10:53:02,009 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:53:02.009039Z"}
2025-08-18 10:53:02,009 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:53:02.009265Z"}
2025-08-18 10:53:02,103 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:53:02.103735Z"}
2025-08-18 10:53:02,104 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:53:02.104940Z"}
2025-08-18 10:53:02,106 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:53:02.106747Z"}
2025-08-18 10:53:02,107 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:53:02.107010Z"}
2025-08-18 10:53:02,107 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:53:02.107725Z"}
2025-08-18 10:53:02,107 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:53:02.107967Z"}
2025-08-18 10:53:02,130 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:53:02.130738Z"}
2025-08-18 10:53:09,235 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpc6qx5wrz.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:53:09.235121Z"}
2025-08-18 10:53:09,235 - stock_etl.core.database - INFO - {"file_size": 18622, "estimated_statements": 86, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:53:09.235521Z"}
2025-08-18 10:53:09,411 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:53:09.411000Z"}
2025-08-18 10:53:09,430 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:53:09.430383Z"}
2025-08-18 10:53:09,431 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:53:09.431021Z"}
2025-08-18 10:53:09,431 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:53:09.431246Z"}
2025-08-18 10:53:09,470 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T08:53:09.470646Z"}
2025-08-18 13:17:46,855 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpoh_mlo3e.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T11:17:46.855862Z"}
2025-08-18 13:17:46,856 - stock_etl.core.database - INFO - {"file_size": 16568, "estimated_statements": 76, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T11:17:46.856267Z"}
2025-08-18 13:17:47,042 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T11:17:47.042146Z"}
2025-08-18 13:17:47,060 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T11:17:47.060345Z"}
2025-08-18 13:17:47,061 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T11:17:47.061066Z"}
2025-08-18 13:17:47,061 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T11:17:47.061362Z"}
2025-08-18 13:17:47,103 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T11:17:47.103034Z"}
2025-08-18 13:17:47,104 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T11:17:47.104529Z"}
2025-08-18 13:17:47,106 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T11:17:47.106458Z"}
2025-08-18 13:17:47,106 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T11:17:47.106749Z"}
2025-08-18 13:17:47,107 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T11:17:47.107340Z"}
2025-08-18 13:17:47,107 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T11:17:47.107573Z"}
2025-08-18 13:17:47,127 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T11:17:47.127001Z"}
2025-08-18 13:17:54,356 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpjye5p0p9.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T11:17:54.356168Z"}
2025-08-18 13:17:54,356 - stock_etl.core.database - INFO - {"file_size": 18622, "estimated_statements": 86, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T11:17:54.356553Z"}
2025-08-18 13:17:54,527 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T11:17:54.527055Z"}
2025-08-18 13:17:54,542 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T11:17:54.542662Z"}
2025-08-18 13:17:54,543 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T11:17:54.543256Z"}
2025-08-18 13:17:54,543 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T11:17:54.543481Z"}
2025-08-18 13:17:54,583 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T11:17:54.583893Z"}
2025-08-18 14:01:02,360 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpi2_xp8rt.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:01:02.360491Z"}
2025-08-18 14:01:02,360 - stock_etl.core.database - INFO - {"file_size": 16568, "estimated_statements": 76, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:01:02.360837Z"}
2025-08-18 14:01:02,525 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:01:02.525157Z"}
2025-08-18 14:01:02,540 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:01:02.540934Z"}
2025-08-18 14:01:02,541 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:01:02.541524Z"}
2025-08-18 14:01:02,541 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:01:02.541751Z"}
2025-08-18 14:01:02,615 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:01:02.615055Z"}
2025-08-18 14:01:02,616 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:01:02.616095Z"}
2025-08-18 14:01:02,618 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:01:02.617982Z"}
2025-08-18 14:01:02,618 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:01:02.618251Z"}
2025-08-18 14:01:02,619 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:01:02.619966Z"}
2025-08-18 14:01:02,620 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:01:02.620212Z"}
2025-08-18 14:01:02,639 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:01:02.639805Z"}
2025-08-18 14:01:09,737 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp7k03i4za.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:01:09.737558Z"}
2025-08-18 14:01:09,737 - stock_etl.core.database - INFO - {"file_size": 18622, "estimated_statements": 86, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:01:09.737936Z"}
2025-08-18 14:01:09,912 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:01:09.912362Z"}
2025-08-18 14:01:09,927 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:01:09.927914Z"}
2025-08-18 14:01:09,928 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:01:09.928549Z"}
2025-08-18 14:01:09,928 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:01:09.928796Z"}
2025-08-18 14:01:09,995 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:01:09.995310Z"}
2025-08-18 14:27:35,181 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpmb8n2bt4.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:27:35.181653Z"}
2025-08-18 14:27:35,182 - stock_etl.core.database - INFO - {"file_size": 16568, "estimated_statements": 76, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:27:35.182021Z"}
2025-08-18 14:27:35,353 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:27:35.353421Z"}
2025-08-18 14:27:35,371 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:27:35.371220Z"}
2025-08-18 14:27:35,371 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:27:35.371967Z"}
2025-08-18 14:27:35,372 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:27:35.372217Z"}
2025-08-18 14:27:35,411 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:27:35.411726Z"}
2025-08-18 14:27:35,412 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:27:35.412841Z"}
2025-08-18 14:27:35,414 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:27:35.414599Z"}
2025-08-18 14:27:35,414 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:27:35.414868Z"}
2025-08-18 14:27:35,415 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:27:35.415433Z"}
2025-08-18 14:27:35,415 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:27:35.415658Z"}
2025-08-18 14:27:35,434 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:27:35.434672Z"}
2025-08-18 14:27:42,677 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp5f2y3pcm.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:27:42.677469Z"}
2025-08-18 14:27:42,677 - stock_etl.core.database - INFO - {"file_size": 18622, "estimated_statements": 86, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:27:42.677853Z"}
2025-08-18 14:27:42,841 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:27:42.841110Z"}
2025-08-18 14:27:42,855 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:27:42.855470Z"}
2025-08-18 14:27:42,856 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:27:42.856065Z"}
2025-08-18 14:27:42,856 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:27:42.856294Z"}
2025-08-18 14:27:42,898 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T12:27:42.898928Z"}
2025-08-18 19:27:19,979 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpmygeh0lo.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:27:19.979702Z"}
2025-08-18 19:27:19,980 - stock_etl.core.database - INFO - {"file_size": 19010, "estimated_statements": 59, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:27:19.980163Z"}
2025-08-18 19:27:20,158 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:27:20.158913Z"}
2025-08-18 19:27:20,178 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:27:20.178151Z"}
2025-08-18 19:27:20,178 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:27:20.178823Z"}
2025-08-18 19:27:20,179 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:27:20.179074Z"}
2025-08-18 19:27:20,209 - stock_etl.core.database - ERROR - {"error": "new row for relation \"stock_prices\" violates check constraint \"ohlc_consistency\"\nDETAIL:  Failing row contains (1, 1, 2025-08-17, 2025-08-17, 1755388800, null, null, 50.169436, 54.398471, 51.566995, 57.063410, 4638, null, 1.000000, 0.000000, sample_data, null, 2025-08-18 17:27:20.178556+00, 1755538040).\n", "error_type": "CheckViolation", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-18T17:27:20.209230Z"}
2025-08-18 19:27:27,302 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpk8ewr9jg.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:27:27.302892Z"}
2025-08-18 19:27:27,303 - stock_etl.core.database - INFO - {"file_size": 14322, "estimated_statements": 51, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:27:27.303290Z"}
2025-08-18 19:27:27,479 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:27:27.479676Z"}
2025-08-18 19:27:27,496 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:27:27.496753Z"}
2025-08-18 19:27:27,497 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:27:27.497364Z"}
2025-08-18 19:27:27,497 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:27:27.497593Z"}
2025-08-18 19:27:27,534 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:27:27.534620Z"}
2025-08-18 19:39:44,977 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpdxvls989.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:39:44.977574Z"}
2025-08-18 19:39:44,977 - stock_etl.core.database - INFO - {"file_size": 19415, "estimated_statements": 59, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:39:44.977962Z"}
2025-08-18 19:39:45,161 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:39:45.161225Z"}
2025-08-18 19:39:45,178 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:39:45.178897Z"}
2025-08-18 19:39:45,179 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:39:45.179539Z"}
2025-08-18 19:39:45,179 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:39:45.179911Z"}
2025-08-18 19:39:45,208 - stock_etl.core.database - ERROR - {"error": "new row for relation \"stock_prices\" violates check constraint \"ohlc_consistency\"\nDETAIL:  Failing row contains (1, 1, 2025-08-17, 2025-08-17, 1755388800, null, null, 52.677897, 60.771375, 54.266429, 53.844767, 4037, null, 1.000000, 0.000000, sample_data, null, 2025-08-18 17:39:45.17926+00, 1755538785).\n", "error_type": "CheckViolation", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-18T17:39:45.208888Z"}
2025-08-18 19:39:52,479 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp4lfp22lw.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:39:52.479557Z"}
2025-08-18 19:39:52,479 - stock_etl.core.database - INFO - {"file_size": 14322, "estimated_statements": 51, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:39:52.479911Z"}
2025-08-18 19:39:52,648 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:39:52.648933Z"}
2025-08-18 19:39:52,666 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:39:52.666366Z"}
2025-08-18 19:39:52,667 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:39:52.667035Z"}
2025-08-18 19:39:52,667 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:39:52.667267Z"}
2025-08-18 19:39:52,703 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:39:52.703891Z"}
2025-08-18 19:45:03,579 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpqwa61x68.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:45:03.579053Z"}
2025-08-18 19:45:03,579 - stock_etl.core.database - INFO - {"file_size": 19652, "estimated_statements": 59, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:45:03.579493Z"}
2025-08-18 19:45:03,754 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:45:03.754294Z"}
2025-08-18 19:45:03,777 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:45:03.777169Z"}
2025-08-18 19:45:03,777 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:45:03.777914Z"}
2025-08-18 19:45:03,778 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:45:03.778241Z"}
2025-08-18 19:45:03,810 - stock_etl.core.database - ERROR - {"error": "new row for relation \"stock_prices\" violates check constraint \"ohlc_consistency\"\nDETAIL:  Failing row contains (4, 1, 2025-08-14, 2025-08-14, 1755129600, null, null, 51.639646, 55.968340, 54.748083, 52.821046, 4063, null, 1.000000, 0.000000, sample_data, null, 2025-08-18 17:45:03.777621+00, 1755539104).\n", "error_type": "CheckViolation", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-18T17:45:03.810009Z"}
2025-08-18 19:45:11,444 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpwm6719zq.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:45:11.443970Z"}
2025-08-18 19:45:11,444 - stock_etl.core.database - INFO - {"file_size": 14322, "estimated_statements": 51, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:45:11.444357Z"}
2025-08-18 19:45:11,612 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:45:11.612709Z"}
2025-08-18 19:45:11,627 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:45:11.627720Z"}
2025-08-18 19:45:11,628 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:45:11.628317Z"}
2025-08-18 19:45:11,628 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:45:11.628545Z"}
2025-08-18 19:45:11,661 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:45:11.660964Z"}
2025-08-18 19:48:01,264 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpfcmxn0l0.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:48:01.264312Z"}
2025-08-18 19:48:01,264 - stock_etl.core.database - INFO - {"file_size": 19652, "estimated_statements": 59, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:48:01.264682Z"}
2025-08-18 19:48:01,436 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:48:01.436648Z"}
2025-08-18 19:48:01,451 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:48:01.451951Z"}
2025-08-18 19:48:01,452 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:48:01.452574Z"}
2025-08-18 19:48:01,452 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:48:01.452890Z"}
2025-08-18 19:48:01,476 - stock_etl.core.database - ERROR - {"error": "new row for relation \"stock_prices\" violates check constraint \"ohlc_consistency\"\nDETAIL:  Failing row contains (1, 1, 2025-08-17, 2025-08-17, 1755388800, null, null, 51.837190, 60.780270, 55.864441, 58.572495, 4013, null, 1.000000, 0.000000, sample_data, null, 2025-08-18 17:48:01.452304+00, 1755539281).\n", "error_type": "CheckViolation", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-18T17:48:01.476488Z"}
2025-08-18 19:50:49,261 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp92jkw23j.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:50:49.261927Z"}
2025-08-18 19:50:49,262 - stock_etl.core.database - INFO - {"file_size": 19628, "estimated_statements": 59, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:50:49.262333Z"}
2025-08-18 19:50:49,449 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:50:49.449604Z"}
2025-08-18 19:50:49,467 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:50:49.467207Z"}
2025-08-18 19:50:49,467 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:50:49.467869Z"}
2025-08-18 19:50:49,468 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:50:49.468122Z"}
2025-08-18 19:50:49,512 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:50:49.512613Z"}
2025-08-18 19:50:49,513 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:50:49.513810Z"}
2025-08-18 19:50:49,515 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:50:49.515886Z"}
2025-08-18 19:50:49,516 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:50:49.516159Z"}
2025-08-18 19:50:49,516 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:50:49.516941Z"}
2025-08-18 19:50:49,517 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:50:49.517169Z"}
2025-08-18 19:50:49,518 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-18T17:50:49.518854Z"}
2025-08-18 19:57:26,604 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmposfs01an.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:57:26.604540Z"}
2025-08-18 19:57:26,604 - stock_etl.core.database - INFO - {"file_size": 19628, "estimated_statements": 59, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:57:26.604903Z"}
2025-08-18 19:57:26,767 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:57:26.766938Z"}
2025-08-18 19:57:26,781 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:57:26.781626Z"}
2025-08-18 19:57:26,782 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:57:26.782196Z"}
2025-08-18 19:57:26,782 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:57:26.782520Z"}
2025-08-18 19:57:26,826 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:57:26.826125Z"}
2025-08-18 19:57:26,827 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:57:26.827296Z"}
2025-08-18 19:57:26,829 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:57:26.829186Z"}
2025-08-18 19:57:26,829 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:57:26.829442Z"}
2025-08-18 19:57:26,830 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:57:26.830120Z"}
2025-08-18 19:57:26,830 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:57:26.830330Z"}
2025-08-18 19:57:26,831 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-18T17:57:26.831848Z"}
2025-08-18 19:57:33,777 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpw1rcsgwc.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:57:33.777014Z"}
2025-08-18 19:57:33,777 - stock_etl.core.database - INFO - {"file_size": 14322, "estimated_statements": 51, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:57:33.777392Z"}
2025-08-18 19:57:33,946 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:57:33.946298Z"}
2025-08-18 19:57:33,962 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:57:33.962778Z"}
2025-08-18 19:57:33,963 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:57:33.963359Z"}
2025-08-18 19:57:33,963 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:57:33.963587Z"}
2025-08-18 19:57:34,001 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:57:34.001095Z"}
2025-08-18 19:59:16,076 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpli_r1t08.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:59:16.076179Z"}
2025-08-18 19:59:16,076 - stock_etl.core.database - INFO - {"file_size": 19628, "estimated_statements": 59, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:59:16.076573Z"}
2025-08-18 19:59:16,252 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:59:16.252198Z"}
2025-08-18 19:59:16,269 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:59:16.269503Z"}
2025-08-18 19:59:16,270 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:59:16.270355Z"}
2025-08-18 19:59:16,270 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:59:16.270610Z"}
2025-08-18 19:59:16,339 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:59:16.339292Z"}
2025-08-18 19:59:16,340 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:59:16.340501Z"}
2025-08-18 19:59:16,342 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:59:16.342541Z"}
2025-08-18 19:59:16,342 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:59:16.342820Z"}
2025-08-18 19:59:16,343 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:59:16.343411Z"}
2025-08-18 19:59:16,343 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:59:16.343651Z"}
2025-08-18 19:59:16,345 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-18T17:59:16.345146Z"}
2025-08-18 19:59:23,533 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp3uo_e1d5.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:59:23.533360Z"}
2025-08-18 19:59:23,533 - stock_etl.core.database - INFO - {"file_size": 14322, "estimated_statements": 51, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:59:23.533723Z"}
2025-08-18 19:59:23,714 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:59:23.714852Z"}
2025-08-18 19:59:23,732 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:59:23.732677Z"}
2025-08-18 19:59:23,733 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:59:23.733375Z"}
2025-08-18 19:59:23,733 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:59:23.733640Z"}
2025-08-18 19:59:23,795 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T17:59:23.795479Z"}
2025-08-18 20:33:24,155 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpd62qyepf.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T18:33:24.155942Z"}
2025-08-18 20:33:24,156 - stock_etl.core.database - INFO - {"file_size": 19628, "estimated_statements": 59, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T18:33:24.156292Z"}
2025-08-18 20:33:24,325 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T18:33:24.325496Z"}
2025-08-18 20:33:24,341 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T18:33:24.341617Z"}
2025-08-18 20:33:24,342 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T18:33:24.342258Z"}
2025-08-18 20:33:24,342 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T18:33:24.342503Z"}
2025-08-18 20:33:24,391 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T18:33:24.390951Z"}
2025-08-18 20:33:24,392 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T18:33:24.392039Z"}
2025-08-18 20:33:24,393 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T18:33:24.393768Z"}
2025-08-18 20:33:24,394 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T18:33:24.394020Z"}
2025-08-18 20:33:24,394 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T18:33:24.394687Z"}
2025-08-18 20:33:24,394 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T18:33:24.394904Z"}
2025-08-18 20:33:24,396 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-18T18:33:24.396457Z"}
2025-08-18 20:33:31,486 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp8_tehyvz.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T18:33:31.486499Z"}
2025-08-18 20:33:31,486 - stock_etl.core.database - INFO - {"file_size": 14322, "estimated_statements": 51, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T18:33:31.486864Z"}
2025-08-18 20:33:31,660 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T18:33:31.660383Z"}
2025-08-18 20:33:31,678 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T18:33:31.678020Z"}
2025-08-18 20:33:31,678 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T18:33:31.678689Z"}
2025-08-18 20:33:31,678 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T18:33:31.678927Z"}
2025-08-18 20:33:31,717 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-18T18:33:31.717188Z"}
2025-08-18 23:34:38,958 - stock_etl.data.stooq_extractor - INFO - {"total_symbols": 14, "event": "Starting bulk symbol extraction", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:38.958413Z"}
2025-08-18 23:34:38,958 - stock_etl.data.stooq_extractor - INFO - {"symbol": "XTB", "progress": "1/14", "instrument_type": "stock", "event": "Processing symbol", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:38.958749Z"}
2025-08-18 23:34:38,959 - stock_etl.data.stooq_extractor - DEBUG - {"symbol": "XTB", "url": "https://stooq.com/q/d/l/?s=XTB&f=csv&i=d", "event": "Built Stooq URL", "logger": "stock_etl.data.stooq_extractor", "level": "debug", "timestamp": "2025-08-18T21:34:38.959037Z"}
2025-08-18 23:34:38,959 - stock_etl.data.stooq_extractor - INFO - {"symbol": "XTB", "url": "https://stooq.com/q/d/l/?s=XTB&f=csv&i=d", "event": "Downloading data from Stooq", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:38.959250Z"}
2025-08-18 23:34:38,961 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): stooq.com:443
2025-08-18 23:34:39,201 - urllib3.connectionpool - DEBUG - https://stooq.com:443 "GET /q/d/l/?s=XTB&f=csv&i=d HTTP/1.1" 200 None
2025-08-18 23:34:39,303 - stock_etl.data.stooq_extractor - DEBUG - {"symbol": "XTB", "size": 136204, "lines": 2307, "first_line": "Date,Open,High,Low,Close,Volume\r", "event": "Received content from Stooq", "logger": "stock_etl.data.stooq_extractor", "level": "debug", "timestamp": "2025-08-18T21:34:39.302959Z"}
2025-08-18 23:34:39,312 - stock_etl.data.stooq_extractor - INFO - {"symbol": "XTB", "file_path": "data/daily/pl/wse-stocks/xtb.txt", "event": "Data saved to file", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:39.312453Z"}
2025-08-18 23:34:39,312 - stock_etl.data.stooq_extractor - INFO - {"symbol": "XTB", "size": 136204, "event": "Successfully downloaded data", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:39.312692Z"}
2025-08-18 23:34:39,406 - stock_etl.data.stooq_extractor - INFO - {"symbol": "XTB", "total_rows": 2305, "valid_records": 2305, "invalid_records": 0, "event": "Parsed CSV data", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:39.406409Z"}
2025-08-18 23:34:39,406 - stock_etl.data.stooq_extractor - INFO - {"symbol": "XTB", "instrument_type": "stock", "records_count": 2305, "date_range": "2025-08-18 to 2016-05-06", "event": "Successfully extracted symbol data", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:39.406875Z"}
2025-08-18 23:34:41,407 - stock_etl.data.stooq_extractor - INFO - {"symbol": "CDR", "progress": "2/14", "instrument_type": "stock", "event": "Processing symbol", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:41.407196Z"}
2025-08-18 23:34:41,407 - stock_etl.data.stooq_extractor - DEBUG - {"symbol": "CDR", "url": "https://stooq.com/q/d/l/?s=CDR&f=csv&i=d", "event": "Built Stooq URL", "logger": "stock_etl.data.stooq_extractor", "level": "debug", "timestamp": "2025-08-18T21:34:41.407682Z"}
2025-08-18 23:34:41,407 - stock_etl.data.stooq_extractor - INFO - {"symbol": "CDR", "url": "https://stooq.com/q/d/l/?s=CDR&f=csv&i=d", "event": "Downloading data from Stooq", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:41.407921Z"}
2025-08-18 23:34:41,565 - urllib3.connectionpool - DEBUG - https://stooq.com:443 "GET /q/d/l/?s=CDR&f=csv&i=d HTTP/1.1" 200 None
2025-08-18 23:34:41,735 - stock_etl.data.stooq_extractor - DEBUG - {"symbol": "CDR", "size": 458490, "lines": 7716, "first_line": "Date,Open,High,Low,Close,Volume\r", "event": "Received content from Stooq", "logger": "stock_etl.data.stooq_extractor", "level": "debug", "timestamp": "2025-08-18T21:34:41.735513Z"}
2025-08-18 23:34:41,744 - stock_etl.data.stooq_extractor - INFO - {"symbol": "CDR", "file_path": "data/daily/pl/wse-stocks/cdr.txt", "event": "Data saved to file", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:41.744228Z"}
2025-08-18 23:34:41,744 - stock_etl.data.stooq_extractor - INFO - {"symbol": "CDR", "size": 458490, "event": "Successfully downloaded data", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:41.744472Z"}
2025-08-18 23:34:41,952 - stock_etl.data.stooq_extractor - INFO - {"symbol": "CDR", "total_rows": 7714, "valid_records": 7714, "invalid_records": 0, "event": "Parsed CSV data", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:41.952306Z"}
2025-08-18 23:34:41,952 - stock_etl.data.stooq_extractor - INFO - {"symbol": "CDR", "instrument_type": "stock", "records_count": 7714, "date_range": "2025-08-18 to 1994-08-02", "event": "Successfully extracted symbol data", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:41.952778Z"}
2025-08-18 23:34:44,528 - stock_etl.data.stooq_extractor - INFO - {"symbol": "ELT", "progress": "3/14", "instrument_type": "stock", "event": "Processing symbol", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:44.527989Z"}
2025-08-18 23:34:44,528 - stock_etl.data.stooq_extractor - DEBUG - {"symbol": "ELT", "url": "https://stooq.com/q/d/l/?s=ELT&f=csv&i=d", "event": "Built Stooq URL", "logger": "stock_etl.data.stooq_extractor", "level": "debug", "timestamp": "2025-08-18T21:34:44.528542Z"}
2025-08-18 23:34:44,529 - stock_etl.data.stooq_extractor - INFO - {"symbol": "ELT", "url": "https://stooq.com/q/d/l/?s=ELT&f=csv&i=d", "event": "Downloading data from Stooq", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:44.529016Z"}
2025-08-18 23:34:44,648 - urllib3.connectionpool - DEBUG - https://stooq.com:443 "GET /q/d/l/?s=ELT&f=csv&i=d HTTP/1.1" 200 None
2025-08-18 23:34:44,783 - stock_etl.data.stooq_extractor - DEBUG - {"symbol": "ELT", "size": 268253, "lines": 4529, "first_line": "Date,Open,High,Low,Close,Volume\r", "event": "Received content from Stooq", "logger": "stock_etl.data.stooq_extractor", "level": "debug", "timestamp": "2025-08-18T21:34:44.783929Z"}
2025-08-18 23:34:44,791 - stock_etl.data.stooq_extractor - INFO - {"symbol": "ELT", "file_path": "data/daily/pl/wse-stocks/elt.txt", "event": "Data saved to file", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:44.791797Z"}
2025-08-18 23:34:44,792 - stock_etl.data.stooq_extractor - INFO - {"symbol": "ELT", "size": 268253, "event": "Successfully downloaded data", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:44.792041Z"}
2025-08-18 23:34:44,897 - stock_etl.data.stooq_extractor - INFO - {"symbol": "ELT", "total_rows": 4527, "valid_records": 4527, "invalid_records": 0, "event": "Parsed CSV data", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:44.897924Z"}
2025-08-18 23:34:44,898 - stock_etl.data.stooq_extractor - INFO - {"symbol": "ELT", "instrument_type": "stock", "records_count": 4527, "date_range": "2025-08-18 to 2007-04-11", "event": "Successfully extracted symbol data", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:44.898526Z"}
2025-08-18 23:34:46,898 - stock_etl.data.stooq_extractor - INFO - {"symbol": "DVL", "progress": "4/14", "instrument_type": "stock", "event": "Processing symbol", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:46.898914Z"}
2025-08-18 23:34:46,899 - stock_etl.data.stooq_extractor - DEBUG - {"symbol": "DVL", "url": "https://stooq.com/q/d/l/?s=DVL&f=csv&i=d", "event": "Built Stooq URL", "logger": "stock_etl.data.stooq_extractor", "level": "debug", "timestamp": "2025-08-18T21:34:46.899505Z"}
2025-08-18 23:34:46,899 - stock_etl.data.stooq_extractor - INFO - {"symbol": "DVL", "url": "https://stooq.com/q/d/l/?s=DVL&f=csv&i=d", "event": "Downloading data from Stooq", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:46.899880Z"}
2025-08-18 23:34:47,048 - urllib3.connectionpool - DEBUG - https://stooq.com:443 "GET /q/d/l/?s=DVL&f=csv&i=d HTTP/1.1" 200 None
2025-08-18 23:34:47,184 - stock_etl.data.stooq_extractor - DEBUG - {"symbol": "DVL", "size": 277725, "lines": 4537, "first_line": "Date,Open,High,Low,Close,Volume\r", "event": "Received content from Stooq", "logger": "stock_etl.data.stooq_extractor", "level": "debug", "timestamp": "2025-08-18T21:34:47.184051Z"}
2025-08-18 23:34:47,192 - stock_etl.data.stooq_extractor - INFO - {"symbol": "DVL", "file_path": "data/daily/pl/wse-stocks/dvl.txt", "event": "Data saved to file", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:47.192096Z"}
2025-08-18 23:34:47,192 - stock_etl.data.stooq_extractor - INFO - {"symbol": "DVL", "size": 277725, "event": "Successfully downloaded data", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:47.192329Z"}
2025-08-18 23:34:47,299 - stock_etl.data.stooq_extractor - INFO - {"symbol": "DVL", "total_rows": 4535, "valid_records": 4535, "invalid_records": 0, "event": "Parsed CSV data", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:47.299236Z"}
2025-08-18 23:34:47,299 - stock_etl.data.stooq_extractor - INFO - {"symbol": "DVL", "instrument_type": "stock", "records_count": 4535, "date_range": "2025-08-18 to 2007-06-29", "event": "Successfully extracted symbol data", "logger": "stock_etl.data.stooq_extractor", "level": "info", "timestamp": "2025-08-18T21:34:47.299797Z"}
2025-08-19 08:21:16,080 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmphd64cmmy.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:21:16.080440Z"}
2025-08-19 08:21:16,081 - stock_etl.core.database - INFO - {"file_size": 19628, "estimated_statements": 59, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:21:16.081041Z"}
2025-08-19 08:21:16,230 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:21:16.230793Z"}
2025-08-19 08:21:16,259 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:21:16.259537Z"}
2025-08-19 08:21:16,260 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:21:16.260289Z"}
2025-08-19 08:21:16,260 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:21:16.260579Z"}
2025-08-19 08:21:16,360 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:21:16.360495Z"}
2025-08-19 08:21:16,361 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:21:16.361911Z"}
2025-08-19 08:21:16,363 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:21:16.363668Z"}
2025-08-19 08:21:16,363 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:21:16.363948Z"}
2025-08-19 08:21:16,364 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:21:16.364597Z"}
2025-08-19 08:21:16,364 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:21:16.364818Z"}
2025-08-19 08:21:16,367 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-19T06:21:16.367229Z"}
2025-08-19 08:21:22,310 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpe1q_g824.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:21:22.310102Z"}
2025-08-19 08:21:22,310 - stock_etl.core.database - INFO - {"file_size": 14322, "estimated_statements": 51, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:21:22.310497Z"}
2025-08-19 08:21:22,467 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:21:22.467121Z"}
2025-08-19 08:21:22,475 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:21:22.475630Z"}
2025-08-19 08:21:22,476 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:21:22.476541Z"}
2025-08-19 08:21:22,476 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:21:22.476857Z"}
2025-08-19 08:21:22,547 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:21:22.546945Z"}
2025-08-19 08:26:19,571 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpvrqh1i7e.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:26:19.571704Z"}
2025-08-19 08:26:19,572 - stock_etl.core.database - INFO - {"file_size": 19628, "estimated_statements": 59, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:26:19.572163Z"}
2025-08-19 08:26:19,718 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:26:19.718442Z"}
2025-08-19 08:26:19,726 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:26:19.726235Z"}
2025-08-19 08:26:19,726 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:26:19.726893Z"}
2025-08-19 08:26:19,727 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:26:19.727124Z"}
2025-08-19 08:26:19,794 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:26:19.794219Z"}
2025-08-19 08:26:19,795 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:26:19.795434Z"}
2025-08-19 08:26:19,797 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:26:19.797452Z"}
2025-08-19 08:26:19,797 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:26:19.797719Z"}
2025-08-19 08:26:19,798 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:26:19.798346Z"}
2025-08-19 08:26:19,798 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:26:19.798596Z"}
2025-08-19 08:26:19,800 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-19T06:26:19.800245Z"}
2025-08-19 08:26:24,344 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp6y4i_h1w.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:26:24.344462Z"}
2025-08-19 08:26:24,344 - stock_etl.core.database - INFO - {"file_size": 14322, "estimated_statements": 51, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:26:24.344869Z"}
2025-08-19 08:26:24,492 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:26:24.492250Z"}
2025-08-19 08:26:24,500 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:26:24.499948Z"}
2025-08-19 08:26:24,500 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:26:24.500596Z"}
2025-08-19 08:26:24,500 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:26:24.500827Z"}
2025-08-19 08:26:24,561 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T06:26:24.560955Z"}
2025-08-19 09:23:00,729 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp03ol2w14.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:23:00.729254Z"}
2025-08-19 09:23:00,729 - stock_etl.core.database - INFO - {"file_size": 19628, "estimated_statements": 59, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:23:00.729677Z"}
2025-08-19 09:23:00,882 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:23:00.882136Z"}
2025-08-19 09:23:00,894 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:23:00.894257Z"}
2025-08-19 09:23:00,895 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:23:00.895035Z"}
2025-08-19 09:23:00,895 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:23:00.895308Z"}
2025-08-19 09:23:00,945 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:23:00.945461Z"}
2025-08-19 09:23:00,947 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:23:00.947015Z"}
2025-08-19 09:23:00,948 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:23:00.948911Z"}
2025-08-19 09:23:00,949 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:23:00.949203Z"}
2025-08-19 09:23:00,950 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:23:00.949988Z"}
2025-08-19 09:23:00,950 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:23:00.950226Z"}
2025-08-19 09:23:00,951 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-19T07:23:00.951919Z"}
2025-08-19 09:23:05,143 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp_ebacgfd.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:23:05.143052Z"}
2025-08-19 09:23:05,143 - stock_etl.core.database - INFO - {"file_size": 14322, "estimated_statements": 51, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:23:05.143506Z"}
2025-08-19 09:23:05,295 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:23:05.295791Z"}
2025-08-19 09:23:05,304 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:23:05.304039Z"}
2025-08-19 09:23:05,304 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:23:05.304743Z"}
2025-08-19 09:23:05,305 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:23:05.305022Z"}
2025-08-19 09:23:05,347 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:23:05.347790Z"}
2025-08-19 09:28:00,095 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpvqscr6zo.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:28:00.095530Z"}
2025-08-19 09:28:00,095 - stock_etl.core.database - INFO - {"file_size": 19628, "estimated_statements": 59, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:28:00.095946Z"}
2025-08-19 09:28:00,251 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:28:00.251696Z"}
2025-08-19 09:28:00,259 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:28:00.259658Z"}
2025-08-19 09:28:00,260 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:28:00.260292Z"}
2025-08-19 09:28:00,260 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:28:00.260583Z"}
2025-08-19 09:28:00,334 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:28:00.334756Z"}
2025-08-19 09:28:00,336 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:28:00.336061Z"}
2025-08-19 09:28:00,338 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:28:00.338159Z"}
2025-08-19 09:28:00,338 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:28:00.338508Z"}
2025-08-19 09:28:00,339 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:28:00.339471Z"}
2025-08-19 09:28:00,339 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:28:00.339759Z"}
2025-08-19 09:28:00,341 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-19T07:28:00.341612Z"}
2025-08-19 09:28:06,494 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpakv4euq4.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:28:06.494035Z"}
2025-08-19 09:28:06,494 - stock_etl.core.database - INFO - {"file_size": 14322, "estimated_statements": 51, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:28:06.494481Z"}
2025-08-19 09:28:06,650 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:28:06.650165Z"}
2025-08-19 09:28:06,659 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:28:06.659207Z"}
2025-08-19 09:28:06,660 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:28:06.660033Z"}
2025-08-19 09:28:06,660 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:28:06.660326Z"}
2025-08-19 09:28:06,724 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:28:06.724911Z"}
2025-08-19 09:39:36,636 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpleh6ya_w.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:39:36.635964Z"}
2025-08-19 09:39:36,636 - stock_etl.core.database - INFO - {"file_size": 19628, "estimated_statements": 59, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:39:36.636343Z"}
2025-08-19 09:39:36,787 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:39:36.787292Z"}
2025-08-19 09:39:36,796 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:39:36.796219Z"}
2025-08-19 09:39:36,796 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:39:36.796914Z"}
2025-08-19 09:39:36,797 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:39:36.797159Z"}
2025-08-19 09:39:36,874 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:39:36.874342Z"}
2025-08-19 09:39:36,875 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:39:36.875521Z"}
2025-08-19 09:39:36,877 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:39:36.877334Z"}
2025-08-19 09:39:36,877 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:39:36.877610Z"}
2025-08-19 09:39:36,878 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:39:36.878243Z"}
2025-08-19 09:39:36,878 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:39:36.878496Z"}
2025-08-19 09:39:36,880 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-19T07:39:36.880082Z"}
2025-08-19 09:39:42,759 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpodosy88c.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:39:42.759519Z"}
2025-08-19 09:39:42,760 - stock_etl.core.database - INFO - {"file_size": 14322, "estimated_statements": 51, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:39:42.760129Z"}
2025-08-19 09:39:42,924 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:39:42.924685Z"}
2025-08-19 09:39:42,933 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:39:42.933192Z"}
2025-08-19 09:39:42,933 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:39:42.933864Z"}
2025-08-19 09:39:42,934 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:39:42.934129Z"}
2025-08-19 09:39:43,002 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T07:39:43.002649Z"}
2025-08-19 10:01:13,383 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpcl84kpru.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:01:13.383884Z"}
2025-08-19 10:01:13,384 - stock_etl.core.database - INFO - {"file_size": 19628, "estimated_statements": 59, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:01:13.384456Z"}
2025-08-19 10:01:13,540 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:01:13.540828Z"}
2025-08-19 10:01:13,554 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:01:13.554542Z"}
2025-08-19 10:01:13,555 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:01:13.555420Z"}
2025-08-19 10:01:13,555 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:01:13.555814Z"}
2025-08-19 10:01:13,612 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:01:13.612783Z"}
2025-08-19 10:01:13,614 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:01:13.614115Z"}
2025-08-19 10:01:13,616 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:01:13.616112Z"}
2025-08-19 10:01:13,616 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:01:13.616425Z"}
2025-08-19 10:01:13,617 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:01:13.617354Z"}
2025-08-19 10:01:13,617 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:01:13.617604Z"}
2025-08-19 10:01:13,619 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-19T08:01:13.619514Z"}
2025-08-19 10:01:19,566 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpj4v7mw1e.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:01:19.566148Z"}
2025-08-19 10:01:19,566 - stock_etl.core.database - INFO - {"file_size": 14322, "estimated_statements": 51, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:01:19.566587Z"}
2025-08-19 10:01:19,717 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:01:19.717242Z"}
2025-08-19 10:01:19,724 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:01:19.724915Z"}
2025-08-19 10:01:19,725 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:01:19.725588Z"}
2025-08-19 10:01:19,725 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:01:19.725851Z"}
2025-08-19 10:01:19,758 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:01:19.758541Z"}
2025-08-19 10:10:36,562 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpwxjf61cl.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:10:36.562066Z"}
2025-08-19 10:10:36,562 - stock_etl.core.database - INFO - {"file_size": 19628, "estimated_statements": 59, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:10:36.562487Z"}
2025-08-19 10:10:36,716 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:10:36.716055Z"}
2025-08-19 10:10:36,727 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:10:36.727862Z"}
2025-08-19 10:10:36,728 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:10:36.728589Z"}
2025-08-19 10:10:36,728 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:10:36.728849Z"}
2025-08-19 10:10:36,776 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:10:36.776267Z"}
2025-08-19 10:10:36,777 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:10:36.777514Z"}
2025-08-19 10:10:36,779 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:10:36.779466Z"}
2025-08-19 10:10:36,779 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:10:36.779777Z"}
2025-08-19 10:10:36,780 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:10:36.780566Z"}
2025-08-19 10:10:36,780 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:10:36.780835Z"}
2025-08-19 10:10:36,782 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-19T08:10:36.782650Z"}
2025-08-19 10:10:42,778 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpgscttawo.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:10:42.778721Z"}
2025-08-19 10:10:42,779 - stock_etl.core.database - INFO - {"file_size": 14322, "estimated_statements": 51, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:10:42.779140Z"}
2025-08-19 10:10:42,932 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:10:42.932388Z"}
2025-08-19 10:10:42,941 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:10:42.941106Z"}
2025-08-19 10:10:42,941 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:10:42.941853Z"}
2025-08-19 10:10:42,942 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:10:42.942131Z"}
2025-08-19 10:10:42,975 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-19T08:10:42.975219Z"}
2025-08-21 00:13:00,588 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp6yofwzrq.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:13:00.588684Z"}
2025-08-21 00:13:00,589 - stock_etl.core.database - INFO - {"file_size": 27830, "estimated_statements": 75, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:13:00.589083Z"}
2025-08-21 00:13:00,770 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:13:00.770010Z"}
2025-08-21 00:13:00,788 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:13:00.788509Z"}
2025-08-21 00:13:00,789 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:13:00.789197Z"}
2025-08-21 00:13:00,789 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:13:00.789469Z"}
2025-08-21 00:13:00,790 - stock_etl.core.database - ERROR - {"error": "syntax error at or near \"WHERE\"\nLINE 300: ...ction_model UNIQUE (instrument_id, is_production) WHERE is_p...\n                                                               ^\n", "error_type": "SyntaxError", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-20T22:13:00.790832Z"}
2025-08-21 00:13:07,085 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpshpkvss0.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:13:07.084996Z"}
2025-08-21 00:13:07,085 - stock_etl.core.database - INFO - {"file_size": 22527, "estimated_statements": 67, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:13:07.085372Z"}
2025-08-21 00:13:07,256 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:13:07.256287Z"}
2025-08-21 00:13:07,264 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:13:07.264866Z"}
2025-08-21 00:13:07,265 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:13:07.265533Z"}
2025-08-21 00:13:07,265 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:13:07.265783Z"}
2025-08-21 00:13:07,266 - stock_etl.core.database - ERROR - {"error": "syntax error at or near \"WHERE\"\nLINE 300: ...ction_model UNIQUE (instrument_id, is_production) WHERE is_p...\n                                                               ^\n", "error_type": "SyntaxError", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-20T22:13:07.266880Z"}
2025-08-21 00:16:37,322 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpgl63xfmb.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:16:37.322492Z"}
2025-08-21 00:16:37,322 - stock_etl.core.database - INFO - {"file_size": 27861, "estimated_statements": 76, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:16:37.322936Z"}
2025-08-21 00:16:37,488 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:16:37.488689Z"}
2025-08-21 00:16:37,501 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:16:37.501601Z"}
2025-08-21 00:16:37,502 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:16:37.502348Z"}
2025-08-21 00:16:37,502 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:16:37.502648Z"}
2025-08-21 00:16:37,562 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:16:37.562206Z"}
2025-08-21 00:16:37,563 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:16:37.563574Z"}
2025-08-21 00:16:37,565 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:16:37.565862Z"}
2025-08-21 00:16:37,566 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:16:37.566184Z"}
2025-08-21 00:16:37,566 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:16:37.566932Z"}
2025-08-21 00:16:37,567 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:16:37.567192Z"}
2025-08-21 00:16:37,569 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-20T22:16:37.569146Z"}
2025-08-21 00:16:44,033 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpsm4vmv4c.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:16:44.033871Z"}
2025-08-21 00:16:44,034 - stock_etl.core.database - INFO - {"file_size": 22558, "estimated_statements": 68, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:16:44.034257Z"}
2025-08-21 00:16:44,190 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:16:44.190736Z"}
2025-08-21 00:16:44,199 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:16:44.199571Z"}
2025-08-21 00:16:44,200 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:16:44.200251Z"}
2025-08-21 00:16:44,200 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:16:44.200502Z"}
2025-08-21 00:16:44,256 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-20T22:16:44.255948Z"}
2025-08-21 07:36:02,981 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpd74d3iqr.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:36:02.981824Z"}
2025-08-21 07:36:02,982 - stock_etl.core.database - INFO - {"file_size": 27861, "estimated_statements": 76, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:36:02.982586Z"}
2025-08-21 07:36:03,193 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:36:03.193621Z"}
2025-08-21 07:36:03,223 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:36:03.223692Z"}
2025-08-21 07:36:03,224 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:36:03.224492Z"}
2025-08-21 07:36:03,224 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:36:03.224798Z"}
2025-08-21 07:36:03,285 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:36:03.285229Z"}
2025-08-21 07:36:03,286 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:36:03.286538Z"}
2025-08-21 07:36:03,288 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:36:03.288504Z"}
2025-08-21 07:36:03,288 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:36:03.288789Z"}
2025-08-21 07:36:03,289 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:36:03.289577Z"}
2025-08-21 07:36:03,289 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:36:03.289819Z"}
2025-08-21 07:36:03,291 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-21T05:36:03.291568Z"}
2025-08-21 07:36:09,721 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp9ttapyut.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:36:09.721393Z"}
2025-08-21 07:36:09,721 - stock_etl.core.database - INFO - {"file_size": 22558, "estimated_statements": 68, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:36:09.721778Z"}
2025-08-21 07:36:09,907 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:36:09.907947Z"}
2025-08-21 07:36:09,926 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:36:09.926125Z"}
2025-08-21 07:36:09,926 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:36:09.926790Z"}
2025-08-21 07:36:09,927 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:36:09.927041Z"}
2025-08-21 07:36:09,983 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:36:09.983327Z"}
2025-08-21 07:41:19,138 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp_a1b4wgm.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:41:19.138026Z"}
2025-08-21 07:41:19,138 - stock_etl.core.database - INFO - {"file_size": 27861, "estimated_statements": 76, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:41:19.138409Z"}
2025-08-21 07:41:19,329 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:41:19.329202Z"}
2025-08-21 07:41:19,345 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:41:19.345515Z"}
2025-08-21 07:41:19,346 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:41:19.346295Z"}
2025-08-21 07:41:19,346 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:41:19.346550Z"}
2025-08-21 07:41:19,440 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:41:19.440706Z"}
2025-08-21 07:41:19,442 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:41:19.442120Z"}
2025-08-21 07:41:19,444 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:41:19.444082Z"}
2025-08-21 07:41:19,444 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:41:19.444357Z"}
2025-08-21 07:41:19,445 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:41:19.445054Z"}
2025-08-21 07:41:19,445 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:41:19.445306Z"}
2025-08-21 07:41:19,448 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-21T05:41:19.448511Z"}
2025-08-21 07:41:28,019 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpwc4_dto0.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:41:28.019178Z"}
2025-08-21 07:41:28,019 - stock_etl.core.database - INFO - {"file_size": 22558, "estimated_statements": 68, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:41:28.019577Z"}
2025-08-21 07:41:28,211 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:41:28.211818Z"}
2025-08-21 07:41:28,228 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:41:28.228743Z"}
2025-08-21 07:41:28,229 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:41:28.229439Z"}
2025-08-21 07:41:28,229 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:41:28.229750Z"}
2025-08-21 07:41:28,321 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T05:41:28.321657Z"}
2025-08-21 12:48:50,506 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpzs9u3b5r.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:48:50.506034Z"}
2025-08-21 12:48:50,506 - stock_etl.core.database - INFO - {"file_size": 27861, "estimated_statements": 76, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:48:50.506476Z"}
2025-08-21 12:48:50,707 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:48:50.707232Z"}
2025-08-21 12:48:50,731 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:48:50.731081Z"}
2025-08-21 12:48:50,731 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:48:50.731830Z"}
2025-08-21 12:48:50,732 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:48:50.732094Z"}
2025-08-21 12:48:50,797 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:48:50.797870Z"}
2025-08-21 12:48:50,799 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:48:50.799413Z"}
2025-08-21 12:48:50,801 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:48:50.801305Z"}
2025-08-21 12:48:50,801 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:48:50.801578Z"}
2025-08-21 12:48:50,802 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:48:50.802321Z"}
2025-08-21 12:48:50,802 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:48:50.802562Z"}
2025-08-21 12:48:50,804 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-21T10:48:50.804887Z"}
2025-08-21 12:48:59,605 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp7pey8ixy.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:48:59.605271Z"}
2025-08-21 12:48:59,605 - stock_etl.core.database - INFO - {"file_size": 22558, "estimated_statements": 68, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:48:59.605689Z"}
2025-08-21 12:49:58,225 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp9ycobaoq.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:49:58.225808Z"}
2025-08-21 12:49:58,226 - stock_etl.core.database - INFO - {"file_size": 27861, "estimated_statements": 76, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:49:58.226226Z"}
2025-08-21 12:49:58,420 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:49:58.420417Z"}
2025-08-21 12:49:58,441 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:49:58.441783Z"}
2025-08-21 12:49:58,442 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:49:58.442452Z"}
2025-08-21 12:49:58,442 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:49:58.442718Z"}
2025-08-21 12:49:58,560 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:49:58.560057Z"}
2025-08-21 12:49:58,561 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:49:58.561247Z"}
2025-08-21 12:49:58,563 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:49:58.563354Z"}
2025-08-21 12:49:58,563 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:49:58.563632Z"}
2025-08-21 12:49:58,564 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:49:58.564374Z"}
2025-08-21 12:49:58,564 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:49:58.564606Z"}
2025-08-21 12:49:58,568 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-21T10:49:58.568354Z"}
2025-08-21 12:50:07,321 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp4gjif726.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:50:07.321609Z"}
2025-08-21 12:50:07,322 - stock_etl.core.database - INFO - {"file_size": 22558, "estimated_statements": 68, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:50:07.322010Z"}
2025-08-21 12:50:07,505 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:50:07.505679Z"}
2025-08-21 12:50:07,522 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:50:07.522247Z"}
2025-08-21 12:50:07,522 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:50:07.522912Z"}
2025-08-21 12:50:07,523 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:50:07.523144Z"}
2025-08-21 12:50:07,571 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:50:07.571213Z"}
2025-08-21 12:52:34,755 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpizhjkrqt.sql", "schema": "prod_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:52:34.755401Z"}
2025-08-21 12:52:34,755 - stock_etl.core.database - INFO - {"file_size": 22564, "estimated_statements": 68, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:52:34.755793Z"}
2025-08-21 12:52:34,949 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "prod_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:52:34.949300Z"}
2025-08-21 12:52:34,966 - stock_etl.core.database - INFO - {"event": "Setting search path to prod_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:52:34.966451Z"}
2025-08-21 12:52:34,967 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:52:34.967119Z"}
2025-08-21 12:52:34,967 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:52:34.967376Z"}
2025-08-21 12:52:35,019 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:52:35.018938Z"}
2025-08-21 12:56:36,016 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpn2jc0d2o.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:36.016811Z"}
2025-08-21 12:56:36,017 - stock_etl.core.database - INFO - {"file_size": 27861, "estimated_statements": 76, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:36.017222Z"}
2025-08-21 12:56:36,213 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:36.213260Z"}
2025-08-21 12:56:36,236 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:36.236058Z"}
2025-08-21 12:56:36,236 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:36.236751Z"}
2025-08-21 12:56:36,237 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:36.237033Z"}
2025-08-21 12:56:36,302 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:36.302492Z"}
2025-08-21 12:56:36,303 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:36.303887Z"}
2025-08-21 12:56:36,305 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:36.305833Z"}
2025-08-21 12:56:36,306 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:36.306115Z"}
2025-08-21 12:56:36,306 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:36.306768Z"}
2025-08-21 12:56:36,307 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:36.307042Z"}
2025-08-21 12:56:36,308 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-21T10:56:36.308760Z"}
2025-08-21 12:56:45,020 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpczwq6fxd.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:45.020857Z"}
2025-08-21 12:56:45,021 - stock_etl.core.database - INFO - {"file_size": 22558, "estimated_statements": 68, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:45.021284Z"}
2025-08-21 12:56:45,218 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:45.218706Z"}
2025-08-21 12:56:45,238 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:45.238364Z"}
2025-08-21 12:56:45,239 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:45.239063Z"}
2025-08-21 12:56:45,239 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:45.239317Z"}
2025-08-21 12:56:45,311 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:45.311219Z"}
2025-08-21 12:56:51,371 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp_zc8f9gd.sql", "schema": "prod_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:51.370979Z"}
2025-08-21 12:56:51,371 - stock_etl.core.database - INFO - {"file_size": 22564, "estimated_statements": 68, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:51.371397Z"}
2025-08-21 12:56:51,565 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "prod_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:51.565391Z"}
2025-08-21 12:56:51,584 - stock_etl.core.database - INFO - {"event": "Setting search path to prod_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:51.584517Z"}
2025-08-21 12:56:51,585 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:51.585245Z"}
2025-08-21 12:56:51,585 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:51.585507Z"}
2025-08-21 12:56:51,642 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T10:56:51.642336Z"}
2025-08-21 13:12:23,418 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpnaskc_c1.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:23.418017Z"}
2025-08-21 13:12:23,418 - stock_etl.core.database - INFO - {"file_size": 27861, "estimated_statements": 76, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:23.418553Z"}
2025-08-21 13:12:23,610 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:23.610533Z"}
2025-08-21 13:12:23,633 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:23.633198Z"}
2025-08-21 13:12:23,633 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:23.633892Z"}
2025-08-21 13:12:23,634 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:23.634162Z"}
2025-08-21 13:12:23,697 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:23.697685Z"}
2025-08-21 13:12:23,699 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:23.698993Z"}
2025-08-21 13:12:23,701 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:23.700973Z"}
2025-08-21 13:12:23,701 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:23.701234Z"}
2025-08-21 13:12:23,701 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:23.701837Z"}
2025-08-21 13:12:23,702 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:23.702108Z"}
2025-08-21 13:12:23,703 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-21T11:12:23.703805Z"}
2025-08-21 13:12:32,269 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpdqlfzand.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:32.269571Z"}
2025-08-21 13:12:32,270 - stock_etl.core.database - INFO - {"file_size": 22558, "estimated_statements": 68, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:32.270031Z"}
2025-08-21 13:12:32,462 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:32.462491Z"}
2025-08-21 13:12:32,481 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:32.481177Z"}
2025-08-21 13:12:32,481 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:32.481867Z"}
2025-08-21 13:12:32,482 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:32.482118Z"}
2025-08-21 13:12:32,547 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:32.547421Z"}
2025-08-21 13:12:41,059 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp92i30vqb.sql", "schema": "prod_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:41.059515Z"}
2025-08-21 13:12:41,059 - stock_etl.core.database - INFO - {"file_size": 22564, "estimated_statements": 68, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:41.059910Z"}
2025-08-21 13:12:41,252 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "prod_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:41.252853Z"}
2025-08-21 13:12:41,269 - stock_etl.core.database - INFO - {"event": "Setting search path to prod_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:41.269940Z"}
2025-08-21 13:12:41,270 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:41.270631Z"}
2025-08-21 13:12:41,270 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:41.270880Z"}
2025-08-21 13:12:41,316 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:12:41.316708Z"}
2025-08-21 13:29:43,271 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpo56y5or7.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:43.271322Z"}
2025-08-21 13:29:43,271 - stock_etl.core.database - INFO - {"file_size": 27861, "estimated_statements": 76, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:43.271751Z"}
2025-08-21 13:29:43,467 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:43.467156Z"}
2025-08-21 13:29:43,489 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:43.489306Z"}
2025-08-21 13:29:43,489 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:43.489958Z"}
2025-08-21 13:29:43,490 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:43.490208Z"}
2025-08-21 13:29:43,559 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:43.559536Z"}
2025-08-21 13:29:43,561 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:43.561021Z"}
2025-08-21 13:29:43,563 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:43.563097Z"}
2025-08-21 13:29:43,563 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:43.563358Z"}
2025-08-21 13:29:43,563 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:43.563969Z"}
2025-08-21 13:29:43,564 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:43.564232Z"}
2025-08-21 13:29:43,566 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-21T11:29:43.566019Z"}
2025-08-21 13:29:52,302 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp3cmul6gu.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:52.302172Z"}
2025-08-21 13:29:52,302 - stock_etl.core.database - INFO - {"file_size": 22558, "estimated_statements": 68, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:52.302623Z"}
2025-08-21 13:29:52,504 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:52.504643Z"}
2025-08-21 13:29:52,524 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:52.524632Z"}
2025-08-21 13:29:52,525 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:52.525360Z"}
2025-08-21 13:29:52,525 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:52.525622Z"}
2025-08-21 13:29:52,584 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:52.584012Z"}
2025-08-21 13:29:58,673 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpmvk75jcb.sql", "schema": "prod_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:58.673909Z"}
2025-08-21 13:29:58,674 - stock_etl.core.database - INFO - {"file_size": 22564, "estimated_statements": 68, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:58.674344Z"}
2025-08-21 13:29:58,865 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "prod_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:58.865648Z"}
2025-08-21 13:29:58,884 - stock_etl.core.database - INFO - {"event": "Setting search path to prod_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:58.884324Z"}
2025-08-21 13:29:58,885 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:58.885047Z"}
2025-08-21 13:29:58,885 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:58.885314Z"}
2025-08-21 13:29:58,938 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:29:58.938214Z"}
2025-08-21 13:55:30,289 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpp93hwyrn.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:30.289189Z"}
2025-08-21 13:55:30,289 - stock_etl.core.database - INFO - {"file_size": 27861, "estimated_statements": 76, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:30.289602Z"}
2025-08-21 13:55:30,491 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:30.491321Z"}
2025-08-21 13:55:30,513 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:30.513781Z"}
2025-08-21 13:55:30,514 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:30.514783Z"}
2025-08-21 13:55:30,515 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:30.515123Z"}
2025-08-21 13:55:30,577 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:30.577212Z"}
2025-08-21 13:55:30,578 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:30.578540Z"}
2025-08-21 13:55:30,580 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:30.580631Z"}
2025-08-21 13:55:30,580 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:30.580940Z"}
2025-08-21 13:55:30,581 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:30.581708Z"}
2025-08-21 13:55:30,581 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:30.581954Z"}
2025-08-21 13:55:30,583 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-21T11:55:30.583936Z"}
2025-08-21 13:55:39,452 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp6ubpa91_.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:39.452835Z"}
2025-08-21 13:55:39,453 - stock_etl.core.database - INFO - {"file_size": 22558, "estimated_statements": 68, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:39.453255Z"}
2025-08-21 13:55:39,657 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:39.657393Z"}
2025-08-21 13:55:39,676 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:39.676144Z"}
2025-08-21 13:55:39,676 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:39.676894Z"}
2025-08-21 13:55:39,677 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:39.677164Z"}
2025-08-21 13:55:39,736 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:39.735985Z"}
2025-08-21 13:55:48,503 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp7g6pow_e.sql", "schema": "prod_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:48.503497Z"}
2025-08-21 13:55:48,504 - stock_etl.core.database - INFO - {"file_size": 22564, "estimated_statements": 68, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:48.504088Z"}
2025-08-21 13:55:48,699 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "prod_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:48.699330Z"}
2025-08-21 13:55:48,717 - stock_etl.core.database - INFO - {"event": "Setting search path to prod_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:48.717562Z"}
2025-08-21 13:55:48,718 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:48.718495Z"}
2025-08-21 13:55:48,718 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:48.718860Z"}
2025-08-21 13:55:48,778 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-21T11:55:48.778572Z"}
2025-08-22 13:32:26,919 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp1cnky8pk.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:26.919653Z"}
2025-08-22 13:32:26,920 - stock_etl.core.database - INFO - {"file_size": 27861, "estimated_statements": 76, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:26.920095Z"}
2025-08-22 13:32:27,160 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:27.160030Z"}
2025-08-22 13:32:27,193 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:27.193016Z"}
2025-08-22 13:32:27,193 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:27.193703Z"}
2025-08-22 13:32:27,193 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:27.193942Z"}
2025-08-22 13:32:27,321 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:27.321420Z"}
2025-08-22 13:32:27,322 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:27.322675Z"}
2025-08-22 13:32:27,324 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:27.324488Z"}
2025-08-22 13:32:27,324 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:27.324754Z"}
2025-08-22 13:32:27,326 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:27.326072Z"}
2025-08-22 13:32:27,326 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:27.326358Z"}
2025-08-22 13:32:27,329 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-22T11:32:27.329932Z"}
2025-08-22 13:32:34,806 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpyjfvogwf.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:34.805990Z"}
2025-08-22 13:32:34,806 - stock_etl.core.database - INFO - {"file_size": 22558, "estimated_statements": 68, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:34.806379Z"}
2025-08-22 13:32:34,986 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:34.986602Z"}
2025-08-22 13:32:35,003 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:35.003573Z"}
2025-08-22 13:32:35,004 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:35.004204Z"}
2025-08-22 13:32:35,004 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:35.004450Z"}
2025-08-22 13:32:35,106 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:35.106223Z"}
2025-08-22 13:32:43,630 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpqw__pp5f.sql", "schema": "prod_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:43.630090Z"}
2025-08-22 13:32:43,630 - stock_etl.core.database - INFO - {"file_size": 22564, "estimated_statements": 68, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:43.630528Z"}
2025-08-22 13:32:43,812 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "prod_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:43.812069Z"}
2025-08-22 13:32:43,828 - stock_etl.core.database - INFO - {"event": "Setting search path to prod_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:43.828705Z"}
2025-08-22 13:32:43,829 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:43.829321Z"}
2025-08-22 13:32:43,829 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:43.829544Z"}
2025-08-22 13:32:43,946 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T11:32:43.946599Z"}
2025-08-22 14:01:33,404 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpxww6xjbk.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:33.404946Z"}
2025-08-22 14:01:33,405 - stock_etl.core.database - INFO - {"file_size": 27861, "estimated_statements": 76, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:33.405303Z"}
2025-08-22 14:01:33,583 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:33.582998Z"}
2025-08-22 14:01:33,604 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:33.604056Z"}
2025-08-22 14:01:33,604 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:33.604671Z"}
2025-08-22 14:01:33,604 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:33.604917Z"}
2025-08-22 14:01:33,657 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:33.657097Z"}
2025-08-22 14:01:33,658 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:33.658457Z"}
2025-08-22 14:01:33,660 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:33.660432Z"}
2025-08-22 14:01:33,660 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:33.660698Z"}
2025-08-22 14:01:33,661 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:33.661284Z"}
2025-08-22 14:01:33,661 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:33.661504Z"}
2025-08-22 14:01:33,663 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-22T12:01:33.663014Z"}
2025-08-22 14:01:41,491 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp46fc1m8h.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:41.491454Z"}
2025-08-22 14:01:41,491 - stock_etl.core.database - INFO - {"file_size": 22558, "estimated_statements": 68, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:41.491821Z"}
2025-08-22 14:01:41,662 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:41.662187Z"}
2025-08-22 14:01:41,679 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:41.679749Z"}
2025-08-22 14:01:41,680 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:41.680381Z"}
2025-08-22 14:01:41,680 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:41.680614Z"}
2025-08-22 14:01:41,739 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:41.739691Z"}
2025-08-22 14:01:49,687 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp2i40s8fa.sql", "schema": "prod_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:49.687838Z"}
2025-08-22 14:01:49,688 - stock_etl.core.database - INFO - {"file_size": 22564, "estimated_statements": 68, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:49.688245Z"}
2025-08-22 14:01:49,864 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "prod_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:49.863982Z"}
2025-08-22 14:01:49,879 - stock_etl.core.database - INFO - {"event": "Setting search path to prod_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:49.879846Z"}
2025-08-22 14:01:49,880 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:49.880453Z"}
2025-08-22 14:01:49,880 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:49.880690Z"}
2025-08-22 14:01:49,930 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:01:49.930011Z"}
2025-08-22 14:22:18,840 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp6nk6dd_i.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:18.840078Z"}
2025-08-22 14:22:18,840 - stock_etl.core.database - INFO - {"file_size": 27861, "estimated_statements": 76, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:18.840458Z"}
2025-08-22 14:22:19,017 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "dev_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:19.017554Z"}
2025-08-22 14:22:19,034 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:19.034927Z"}
2025-08-22 14:22:19,035 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:19.035595Z"}
2025-08-22 14:22:19,035 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:19.035844Z"}
2025-08-22 14:22:19,090 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:19.090527Z"}
2025-08-22 14:22:19,091 - stock_etl.core.database - INFO - {"file_path": "sql/dev_dummy_data.sql", "schema": "dev_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:19.091663Z"}
2025-08-22 14:22:19,094 - stock_etl.core.database - INFO - {"file_size": 10461, "estimated_statements": 81, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:19.094298Z"}
2025-08-22 14:22:19,094 - stock_etl.core.database - INFO - {"event": "Setting search path to dev_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:19.094632Z"}
2025-08-22 14:22:19,095 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:19.095419Z"}
2025-08-22 14:22:19,095 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:19.095765Z"}
2025-08-22 14:22:19,098 - stock_etl.core.database - ERROR - {"error": "column \"classification_system\" of relation \"sectors\" does not exist\nLINE 1: INSERT INTO sectors (name, description, classification_syste...\n                                                ^\nQUERY:  INSERT INTO sectors (name, description, classification_system)\n    VALUES \n        ('Financial Services', 'Banks, brokerages, insurance companies', 'GICS'),\n        ('Energy', 'Oil, gas, renewable energy companies', 'GICS'),\n        ('Technology', 'Software, hardware, IT services', 'GICS')\n    ON CONFLICT (name) DO NOTHING\nCONTEXT:  PL/pgSQL function inline_code_block line 45 at SQL statement\n", "error_type": "UndefinedColumn", "event": "Failed to execute SQL block", "logger": "stock_etl.core.database", "level": "error", "timestamp": "2025-08-22T12:22:19.098228Z"}
2025-08-22 14:22:27,322 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmp72qxjm20.sql", "schema": "test_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:27.322241Z"}
2025-08-22 14:22:27,322 - stock_etl.core.database - INFO - {"file_size": 22558, "estimated_statements": 68, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:27.322643Z"}
2025-08-22 14:22:27,501 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "test_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:27.501698Z"}
2025-08-22 14:22:27,519 - stock_etl.core.database - INFO - {"event": "Setting search path to test_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:27.519001Z"}
2025-08-22 14:22:27,519 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:27.519884Z"}
2025-08-22 14:22:27,520 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:27.520207Z"}
2025-08-22 14:22:27,577 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:27.577031Z"}
2025-08-22 14:22:35,903 - stock_etl.core.database - INFO - {"file_path": "/tmp/tmpj3617fqi.sql", "schema": "prod_stock_data", "database": "stock_data", "event": "Starting SQL file execution", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:35.903605Z"}
2025-08-22 14:22:35,904 - stock_etl.core.database - INFO - {"file_size": 22564, "estimated_statements": 68, "event": "SQL file loaded", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:35.904146Z"}
2025-08-22 14:22:36,099 - stock_etl.core.database - INFO - {"host": "localhost", "database": "stock_data", "schema": "prod_stock_data", "event": "Database engine created", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:36.099895Z"}
2025-08-22 14:22:36,120 - stock_etl.core.database - INFO - {"event": "Setting search path to prod_stock_data", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:36.119981Z"}
2025-08-22 14:22:36,120 - stock_etl.core.database - INFO - {"event": "Search path set successfully", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:36.120635Z"}
2025-08-22 14:22:36,120 - stock_etl.core.database - INFO - {"event": "Executing complete SQL block as f-string", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:36.120864Z"}
2025-08-22 14:22:36,167 - stock_etl.core.database - INFO - {"event": "Successfully executed complete SQL block", "logger": "stock_etl.core.database", "level": "info", "timestamp": "2025-08-22T12:22:36.167618Z"}
